# Network Module

Модуль низкоуровневой работы с сетью. Мы не используем высокоуровневые фреймворки типа `tokio-tungstenite`, так как они скрывают аллокации и копирования.

## Как это работает?

### WS Client (`ws_client.rs`)

*   **Структура:** `WsClient` оборачивает `mio::net::TcpStream`.
*   **Рукопожатие:** Мы реализуем WebSocket handshake вручную поверх TCP сокета из `mio`.
    *   Формируем HTTP GET запрос с заголовками `Upgrade: websocket`, `Connection: Upgrade` и фиксированным `Sec-WebSocket-Key` (или генерируем его без аллокаций).
    *   Отправляем его через `write_all` в неблокирующий сокет.
*   **Zero-Copy:** Мы не десериализуем входящие JSON сообщения в Rust-структуры целиком. Вместо этого мы используем `simd-json` для парсинга "на месте" (in-place) прямо в буфере чтения, извлекая только поля `p` (price) и `q` (qty).

### TCP Optimizations (`tcp_opt.rs`)

*   **TCP_NODELAY:** Отключаем алгоритм Nagle (`set_nodelay(true)`), чтобы пакеты отправлялись немедленно, не дожидаясь заполнения сегмента. Критично для отправки ордеров.
*   **Non-blocking:** Инициализируем сокет через `socket2` и сразу переводим в `nonblocking` режим перед `connect`, чтобы не блокировать Hot Thread на этапе подключения.
